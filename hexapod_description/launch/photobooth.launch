<launch>

  <arg name="name"/>
  <arg name="pic_prefix"/>

  <include file="$(find gazebo_ros)/launch/empty_world.launch">
    <env name="LC_NUMERIC" value="C"/> <!-- See http://answers.ros.org/question/199401/problem-with-indigo-and-gazebo-22/ -->
    <arg name="world_name" value="$(find hexapod_gazebo)/worlds/hexapod.world"/>
    <arg name="gui" value="false"/>
  </include>

  <param name="robot_description" command="$(find xacro)/xacro.py $(find hexapod_description)/model/gen_tetrapod.urdf.xacro model_path:=$(env HOME)/.ros/hexapod_description/$(arg name)"/>

  <node name="spawn_hexapod" pkg="gazebo_ros" type="spawn_model" args="-param robot_description -urdf -model tetrapod"/>

  <param name="camera_description" textfile="$(find hexapod_description)/model/camera.urdf"/>

  <node name="spawn_camera" pkg="gazebo_ros" type="spawn_model" args="-param camera_description -urdf -model camera"/>

  <node name="image_saver" pkg="image_view" type="image_saver">
    <remap from="image" to="camera/image_raw"/>
    <param name="save_all_image" value="false"/>
    <param name="filename_format" value="$(arg pic_prefix).png"/>
  </node>

  <node name="auto_trigger" pkg="hexapod_description" type="auto_trigger" required="true" output="screen"/>

</launch>
